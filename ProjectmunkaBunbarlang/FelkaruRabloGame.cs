using System;
using System.Threading;

namespace Szerencsejatek
{
    public class FelkaruRabloGame
    {
        private FelikaruRabloLogika jatek;

        public FelkaruRabloGame()
        {
            jatek = new FelikaruRabloLogika(); 
        }

        public void Start()
        {
            FejlecKiiras();
            

            while (jatek.VanPenze())
            {
                Console.WriteLine($"\nEgyenleged: {jatek.Egyenleg} Ft");
                Console.Write("Tét (vagy 'kilep'): ");
                string bemenet = Console.ReadLine();

                if (bemenet.ToLower() == "kilep") break;

                if (int.TryParse(bemenet, out int tet))
                {
                    if (jatek.TetErvenyes(tet))
                    {
                        PorgetesEredmeny eredmeny = jatek.Porgetes(tet);
                        AnimacioEsEredmeny(eredmeny);
                    }
                    else
                    {
                        Console.WriteLine("Hiba: Nincs ennyi pénzed vagy rossz az összeg.");
                    }
                }
                else
                {
                    Console.WriteLine("Kérlek számot adj meg!");
                }
            }

            Console.Write("\nA játéknak vége. Viszlát!");
            Console.ReadKey();
        }

        // UI Segédfüggvények
        private void FejlecKiiras()
        {
            Console.Title = "Félkarú Rabló";
            Console.ForegroundColor = ConsoleColor.Cyan;
            Console.WriteLine("===================");
            Console.WriteLine("   FÉLKARÚ RABLÓ");
            Console.WriteLine("===================");
            Console.ResetColor();
        }

        private void AnimacioEsEredmeny(PorgetesEredmeny eredmeny)
        {
            Console.WriteLine();
            Console.Write("Pörgetés: ");

            // Kis animáció a szimbólumok megjelenéséhez
            foreach (var szimbolum in eredmeny.Szimbolumok)
            {
                Thread.Sleep(300);
                Console.Write($"[ {szimbolum} ] ");
            }
            Console.WriteLine();

            if (eredmeny.Jackpot)
            {
                Console.ForegroundColor = ConsoleColor.Yellow;
                Console.WriteLine($"JACKPOT! Nyertél: {eredmeny.Nyeremeny} Ft");
                Console.Write(":...................................................................................................\r\n:...................................................................................................\r\n:...................................................................................................\r\n:...................................................................................................\r\n:...................................................................................................\r\n:...................................................................................................\r\n:...................................................................................................\r\n:...................................................................................................\r\n:...................................................................................................\r\n:................................::::::::::::::::::.................................................\r\n:..........................::::::::::::::::::::::::::::.............................................\r\n:.........................::::::::::::::::::::::::::::::::..........................................\r\n:.....................::::::::::=::::::::::::::::::::::::::::.......................................\r\n:...............:::..:::::::::::::::::::::::::::::::::::::::::::....................................\r\n:.............:::-::::::::::::::::::::::::::::::::::::::::::::::-:..................................\r\n:............:-=+-::::::::::::::::::::::::::::::::::::::::::::::-=-:................................\r\n:..........:-=+##-:::::::::::::::::::::::::::::::::::::::::::::::#+=:.:--:..........................\r\n:........:--+#%%*::::::::::::::::::::::::::::::::::::::::::::::.:+#*=-:=====-.......................\r\n:........:-+%%%#-::::::::::::::::::::::::::::::::::::::::::::::::-@%*+:====+==========-=--:.....:===\r\n:.......--+#%%%=:::::::::::::::::::::::::-::::::::::::::::::::::::+%%+=.+++++++++++++=+++++========+\r\n:.....::-=#%%%+-:::::::::::::::::::--------::-:::-:::::::::::::::::%%#+-=**********************+++++\r\n:.::-:.-=*%--#=:::::::::::::-::-----------------------::::::::::::.-%%*=:*****####****###******++***\r\n=-=--:--=*-=#=-::::::::-:-=========------::::-------==---===---::.::%#*=--#*************##**#*#*###*\r\n::::::-=+*::*-:::::::---=====+======---::::::------===+++=+====---..:##+=:*##*#**####*+*###**###*#**\r\n+===---=#-=+-::::::---=======+++++===--::::::::--===+++++=======---.:-**=--##*###########*######***#\r\n:....--+*..=:::::---==-+*#####*+**+==---:::::::--==+****####*++===-:::*#+=:**##################***##\r\n:...:-=*+:=-:::::--==+*+*####**#*++==--::::::::::-=+*##+####*+*+==--::.#*=-+#######***####******#*##\r\n:...:-=*=.=::::::----=====+=+++++==---::::::::::::--=+++++====----:::::=#=--*****************+++*+++\r\n:...:-+*-:::::::::------=========----:::::::::::::::--======--::::::::::#+=:***************++***++++\r\n:...:-+#:-::::::::-----------------::::::::::::::::::-----:::::::::::::::*=-**********#***++*++++*##\r\n:...:-*#.::::::::-----------------::-::::::::::::::::::--::::-----:::::::*+-*****#*#****##*+**+++**+\r\n:...:=*#:::::::::---------------:::::::::::::::::::::::::::---------::-::*+-=+*++++====+++##***++*#*\r\n:...:=**:::::-----------------::::::::::::::::--:::::::::::-----------:::*+-.::.:.::::+++++==+*++*++\r\n:....=*:::::::----------------::::::::---------------:::::-:---:-----:::::+...........:.-++*++++++**\r\n:....:+.:::::-------------::::::::::---------=====----::::::----------::::-.........:..:+#+##*++++*+\r\n:......:::::--------------::::::::------===-========-----::::-------::::::........:..:##*%###*##*###\r\n:.......::::::-----------:::::::---================+====--::::-=----::::::......:-++***#############\r\n:.......:::::::::-------:::::::--=-=#%%%%+==-==-*%%%%#+=---:::------::::::...::...:=+#***###%#######\r\n:......::::::::::------==--:::--=-=+#%%##*====-=##%###+===--:-------:::::::....:.:.:::=+*#####%%####\r\n:......::::::::::--------=-:-:-=====**#**=====-=-+***+=====-:-------:::::::.......:...-=+###########\r\n:......::::---------------==----=========================-=--------::::::::.......:.:..:-=*%%##%##%#\r\n:......:::------------------==-==========================----------::::::::...:::::::::=*#*%%#####%%\r\n:....:.::::------------------==**++==================++++=-::------::::::::......:::::-+=*###%######\r\n-::....:::--------------------==+++++************++++====-::::-----::::::::.:.::::.:-%+%-*%##%%%##%#\r\n::..::.:::----------------------===+++++++++++++++=====--:::::-----::::::::.:.:::::.::::*#%%###%%%%#\r\n::::...::------------------------=====================---:::::-----:::::::::::::::=::::-*#%%##%###%%\r\n-::::.:::-----------------------===================------:::::---:::::-:::::.:::::::::-+=#*%%##%%%%%\r\n:...-#*#:-------------------------=====------------------::::------:---::..::::::::::::::+*###%#%%%%\r\n:::.=##%*--=-=====---===--==--===--======----=-------------------------:::::::::.:::::::-+*+:=+*##*#\r\n-:::*%##%%=====================================--=----------------------.:::::::::::::::::::::::+**#\r\n:*%#*###%%%*++======================+======================-----------*##+::::::::::::::::::::.:*=**\r\n**%%%#%##%%%#*++++====+=======++++++++++++++++==============---------#%%%##-:::::::::::::::::::-=:::\r\n+++*%%%%%%%%%%##*++++++++++++++++++++++++++++++==============------:.#%%%%#*=:::::::::::::::.:+-+##%\r\n*+***#%%%%%%%%%%#**++++++++++++++++++++++++++++++===========--------:-%%%%##*+-::::::::.:--:%+--+%#%\r\n*****##%%%%%%%%%%##***++++++++++++++++++++++++++===============------:#@@%####*+:::::::::-:---=#%%%%\r\n**######%%%%%%%%%#####*****+++++++++++++++++++=================--------%%@%###**+-::::::--::::*%####\r\n#########%%####%%#######*#******+*+++++++++++++===============-=======--##%%####++=+::::-:--+:=*##*#\r\n##********#%%%%%#########**********++++++++++++++====+==========-========*#%%%#*+**+--:-=--:--*#*+#%\r\n#*******###%%%########%####**************+++++++++++========----======+=++##%#####*++=--:--::-*%%%*%\r\n#######***#%%##%%%#**###*#####***********+++++++============----======+++**#%#%%#*++*++-:::--=%%%%%%\r\n###**#######%%%%##%####*#########****++++++++++=============-----=====++*+**#%%#**###+++---=*=%#%*++\r\n#########*#*#%%@%%%###########%%#********+++++++===========-------====+++++*#%##%###*#++=-=*+%%*#%##\r\n%#####*########%%@@%###%%####*####%***+++++++++++++=======-------====++++++*#%%%######*+++%#%#%%%%##\r\n####%%%#####%%%%%%%%%%%######*####%###*++++++===============-----=+++++++++**%%%%###**#*+=#%#%%%#%##\r\n#%%%%#########%%##%%##%%%%#**##*##*#######***++++========++++++++++++++++***##%######*****+#%#**=*#*\r\n%##%############%%%%%##%%%%%%#*###**########*****++++++++++++**+++++++*++*++*#%%#####*+##*#*%%%##@#%\r\n%###%%%%###%%%%%####%##%%%#%%%%#*##**#****#####******++++++++++++++++++++*+++*%%##********#*%%%%%*+%\r\n%%##%%%%%%%##%%%%%%%%%##%%%%%%%%%%###**#**#%%%%#***+******+++*****+++++++++++*#%##********#*++#+*%#%\r\n###%%%%%%%%##%%%%%%##%%###%####%%%%%######%###%##%%*+*+++++++++***+++++++++++*#%##*******++**##%%%%%\r\n###%%%%%%%%##%%%%%%###%###%%##%%%%%%%%####%###%###%%%*++*+++++++++++++++++++***%%#**********+*+*%%%%\r\n##*#%%%%%%%%#%%%%%%%#%%%###%#%#%%%%%%%####%###%###%%%%*++++++**++++++++++++++**#%%#**+*++#*#=-+###*+\r\n##%%%%%%%%%%%%%%%%%%%#%%%##%####%%%%%%%######%%###%%##%+++++++++++++++++++++++*#%%#****++***++=-=+*#\n");
            }
            else if (eredmeny.Nyeremeny > 0)
            {
                Console.ForegroundColor = ConsoleColor.Green;
                Console.WriteLine($"Nyertél: {eredmeny.Nyeremeny} Ft");
            }
            else
            {
                Console.ForegroundColor = ConsoleColor.DarkGray;
                Console.WriteLine("Nem nyertél.");
            }
            Console.ResetColor();
            Console.WriteLine("----------------------------------------");
        }
    }
}